'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var tslib_es6 = require('../../../node_modules/tslib/tslib.es6.js');
var Lvl = require('./Lvl.js');
var OpenXML = require('../../../OpenXML.js');

/**
 * lvl 的解析，只支持部分
 * http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/abstractNum.html
 */
var AbstractNum = /** @class */ (function () {
    function AbstractNum() {
        this.lvls = {};
    }
    AbstractNum.fromXML = function (word, element) {
        var e_1, _a;
        var abstractNum = new AbstractNum();
        abstractNum.abstractNumId = element.getAttribute('w:abstractNumId') || '';
        abstractNum.multiLevelType = element.getAttribute('w:multiLevelType');
        var lvls = element.getElementsByTagName('w:lvl');
        try {
            for (var lvls_1 = tslib_es6.__values(lvls), lvls_1_1 = lvls_1.next(); !lvls_1_1.done; lvls_1_1 = lvls_1.next()) {
                var child = lvls_1_1.value;
                var lvlId = child.getAttribute('w:ilvl') || '';
                abstractNum.lvls[lvlId] = Lvl.Lvl.fromXML(word, child);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (lvls_1_1 && !lvls_1_1.done && (_a = lvls_1.return)) _a.call(lvls_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        var multiLevelType = element.querySelector('multiLevelType');
        if (multiLevelType) {
            abstractNum.multiLevelType = OpenXML.getVal(multiLevelType);
        }
        return abstractNum;
    };
    return AbstractNum;
}());

exports.AbstractNum = AbstractNum;
